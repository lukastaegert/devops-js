<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Own your build step—own your code</title>
    <link rel="stylesheet" href="node_modules/reveal.js/dist/reveal.css" />
    <link rel="stylesheet" href="node_modules/codemirror/lib/codemirror.css" />
    <link rel="stylesheet" href="node_modules/reveal.js/plugin/highlight/zenburn.css" />
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section
          data-background-image="img/rollup-left.svg"
          data-background-color="#FF5023"
          data-background-transition="zoom"
          data-background-position="left"
          class="center"
        >
          <h3 style="margin: 0">Own your</h3>
          <h1 style="margin: 0; font-weight: bold">Build Step</h1>
          <h3 style="margin: 0">—own your code</h3>
          <div class="name-box">
            <div style="white-space: nowrap">Lukas Taegert-Atkinson</div>
            <img src="img/tng.svg" />
          </div>
        </section>

        <section class="center">
          <blockquote>Why don't we run JavaScript like a scripting language any more?</blockquote>
          <aside class="notes">Why are using complex build pipelines?</aside>
        </section>

        <section>
          <div class="left-align-box">
            <h2>Exhibit A</h2>
            <div>web application (slow network)</div>
            <div class="sub-heading">
              <a href="https://github.com/TNG/next-generation-scrum-poker"
                >github.com/TNG/next-generation-scrum-poker</a
              >
            </div>
            <div style="display: flex; flex-direction: row; text-align: left; margin-top: 20px">
              <div>
                <div class="section-appear first">loaded: 18.29s</div>
                <div class="section-appear second">
                  <img
                    src="img/waterfall-slow.png"
                    style="width: 200px; margin: 0; border-radius: 10px"
                  />
                </div>
              </div>
              <div style="align-self: center" class="fragment" data-fragment-index="1">
                <div>bundle code</div>
                <div>(no minification)</div>
                <svg style="width: 300px; height: 60px">
                  <g>
                    <path
                      d="M5,10 h270 l-20,5 l10,-5 l10,0 l-20,-5 l10,5"
                      pathLength="100"
                      class="arrow-line fragment-selfdraw"
                    />
                  </g>
                </svg>
              </div>
              <div class="fragment" data-fragment-index="1">
                <div class="appear first">loaded: 7.48s</div>
                <div class="appear second">
                  <img
                    src="img/waterfall-fast.png"
                    style="width: 300px; margin: 0; border-radius: 10px"
                  />
                </div>
                <ul class="fragment" data-fragment-index="2">
                  <li>No loading<br />waterfall</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        <section>
          <div class="left-align-box" style="width: 90%">
            <h2>Exhibit B</h2>
            <div>node server</div>
            <div class="sub-heading">
              <a href="https://www.apollographql.com/docs/apollo-server/getting-started/"
                >apollographql.com/docs/apollo-server/getting-started</a
              >
            </div>
            <terminal-page input-value="docker images -f 'reference=node'"></terminal-page>
          </div>
        </section>

        <section class="center">
          <blockquote>Bundling eliminates the<br />load/parse waterfall.</blockquote>
          <blockquote class="fragment">
            Also for <strong>cloud functions</strong>,<br /><strong>command line tools</strong
            >,<br />…
          </blockquote>
        </section>

        <section>
          <div class="left-align-box">
            <h2>
              <img
                src="img/rollup.svg"
                style="height: 64px; margin: -24px 30px -10px 0; vertical-align: middle"
              />Rollup
            </h2>
            <div class="section-appear first">
              No assumptions about target environment<br />
              (browser, Node, …)
            </div>
            <ul class="fragment" data-fragment-index="1">
              <li>customize via plugins</li>
              <li>six output formats (ES, CommonJS, …)</li>
            </ul>

            <div class="fragment" data-fragment-index="2">No-overhead ES module bundling</div>
            <ul class="fragment appear first" data-fragment-index="2">
              <li>ideal for libraries/intermediate files</li>
            </ul>
            <div class="fragment" data-fragment-index="3">
              Best-of-class no-setup dead-code-elimination
            </div>
          </div>
        </section>

        <section>
          <div class="left-align-box">
            <h2>Using rollup</h2>
            <!-- TODO speech bubbles for input, output, plugins that also put a bracket under the code -->
            <h3 class="section-appear first">Command line</h3>
            <code class="small-code-block section-appear second"
              >npx rollup <span>main.js</span> -o bundle.js -f cjs -p node-resolve -p commonjs -p
              json</code
            >
            <h3 class="fragment" data-fragment-index="1">Configuration file</h3>
            <div class="fragment appear first" data-fragment-index="1">
              <static-codemirror>
                <pre>
import nodeResolve from '@rollup/plugin-node-resolve';
import commonjs from '@rollup/plugin-commonjs';
import json from '@rollup/plugin-json';

export default {
  input: 'main.js',
  plugins: [nodeResolve(), commonjs(), json()],
  output: {
    format: 'cjs'
  }
}
                </pre>
              </static-codemirror>
            </div>
          </div>
        </section>

        <section class="center">
          <div>We own the build step, now let's</div>
          <h1 class="section-appear first" style="margin: 0">Own the code</h1>
          <div class="fragment">—write our own plugins!</div>
        </section>

        <section>
          <div class="left-align-box">
            <h3>1. Inject information</h3>
            <rollup-page code-sample="injectInformation"></rollup-page>
          </div>
        </section>

        <section>
          <div class="left-align-box">
            <h3>2. Patch up files</h3>
            <rollup-page code-sample="patchFiles"></rollup-page>
          </div>
        </section>

        <section>
          <h2>Module life-cycle</h2>
          <div>Image showing how it works</div>
        </section>

        <section>
          <div class="left-align-box">
            <h3>3. Replace files</h3>
            <rollup-page code-sample="mockFiles"></rollup-page>
          </div>
        </section>

        <section>
          <div class="left-align-box">
            <h3>4. Add virtual modules</h3>
            <rollup-page code-sample="virtualModules"></rollup-page>
          </div>
        </section>

        <section>
          <div class="left-align-box">
            <h3>5. Access output information</h3>
            <rollup-page code-sample="buildInformation"></rollup-page>
          </div>
        </section>

        <section class="center">
          <h1>There is much more...</h1>
          <div class="section-appear first">Check out the documentation:</div>
          <a class="section-appear first" href="https://rollupjs.org/guide/en/#plugin-development"
            >rollupjs.org/guide/en/#plugin-development</a
          >
        </section>
        <section data-transition="slide-in zoom-out">
          <div class="left-align-box">
            <h2>High level tooling</h2>
            <h3 class="fragment" data-fragment-index="1">Frontend dev tools powered by Rollup</h3>
            <ul class="fragment appear first" data-fragment-index="1">
              <li>
                <img
                  src="img/stencil.png"
                  style="height: 40px; vertical-align: middle; margin: -20px 6px -10px 0"
                  alt="Stencil logo"
                /><a href="https://stenciljs.com/">Stencil</a>
              </li>
              <li>
                <img
                  src="img/vite.svg"
                  style="height: 40px; vertical-align: middle; margin: -20px 14px -10px 0"
                  alt="Vite logo"
                /><a href="https://vitejs.dev/">Vite</a>
              </li>
              <li><a href="https://github.com/preactjs/wmr">WMR</a></li>
            </ul>
            <h3 class="fragment" data-fragment-index="2">Library bundlers powered by Rollup</h3>
            <ul class="fragment appear first" data-fragment-index="2">
              <li><a href="https://github.com/developit/microbundle">microbundle</a></li>
              <li>
                <img
                  src="img/tsdx.svg"
                  style="height: 40px; vertical-align: middle; margin: -20px 10px -10px 0"
                  alt="TSDX logo"
                /><a href="https://tsdx.io/">TSDX</a>
              </li>
            </ul>
          </div>
        </section>

        <section
          class="center"
          data-background-image="img/rollup-left.svg"
          data-background-color="#FF5023"
          data-background-transition="fade"
          data-background-position="left"
          data-transition="fade"
        >
          <h1 style="margin: 0">Thank you</h1>
          <h2 style="margin: 0">& happy bundling!</h2>
          <div class="name-box">
            <div style="white-space: nowrap">Lukas Taegert-Atkinson</div>
            <img src="img/tng.svg" />
          </div>
        </section>
      </div>
    </div>

    <script src="node_modules/reveal.js/dist/reveal.js"></script>
    <script src="node_modules/reveal.js/plugin/highlight/highlight.js"></script>
    <script src="node_modules/reveal.js/plugin/notes/notes.js"></script>
    <script src="node_modules/codemirror/lib/codemirror.js"></script>
    <script src="node_modules/codemirror/mode/javascript/javascript.js"></script>
    <script src="js/setup.js" type="module"></script>
  </body>
</html>
